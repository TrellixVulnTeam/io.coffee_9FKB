debuglog = (set) ->
  set = set.toUpperCase()
  unless debugs[set]
    if new RegExp("\\b" + set + "\\b", "i").test(debugEnviron)
      pid = process.pid
      debugs[set] = ->
        msg = util.format.apply(exports, arguments)
        console.error "%s %d: %s", set, pid, msg
        return
    else
      debugs[set] = ->
  debugs[set]
util = require("util")
module.exports = (util and util.debuglog) or debuglog
debugs = {}
debugEnviron = process.env.NODE_DEBUG or ""
