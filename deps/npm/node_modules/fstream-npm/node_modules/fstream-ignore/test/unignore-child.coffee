# ignore most things
IgnoreFile = require("../")

# set the ignores just for this test
c = require("./common.js")
c.ignores ".ignore": [
  "*"
  "a"
  "c"
  "!a/b/c/.abc"
  "!/c/b/a/cba"
]

# the only files we expect to see
expected = [
  "/a/b/c/.abc"
  "/a"
  "/a/b"
  "/a/b/c"
  "/c/b/a/cba"
  "/c"
  "/c/b"
  "/c/b/a"
]
require("tap").test "basic ignore rules", (t) ->
  t.pass "start"
  IgnoreFile(
    path: __dirname + "/fixtures"
    ignoreFiles: [".ignore"]
  ).on("child", (e) ->
    p = e.path.substr(e.root.path.length)
    i = expected.indexOf(p)
    if i is -1
      t.fail "unexpected file found",
        f: p

    else
      t.pass p
      expected.splice i, 1
    return
  ).on "close", ->
    t.notOk expected.length, "all expected files should be seen"
    t.end()
    return

  return

