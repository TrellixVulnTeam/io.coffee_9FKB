mkdirp = require("../")
path = require("path")
test = require("tap").test
mockfs = require("mock-fs")
test "opts.fs", (t) ->
  t.plan 5
  x = Math.floor(Math.random() * Math.pow(16, 4)).toString(16)
  y = Math.floor(Math.random() * Math.pow(16, 4)).toString(16)
  z = Math.floor(Math.random() * Math.pow(16, 4)).toString(16)
  file = "/beep/boop/" + [
    x
    y
    z
  ].join("/")
  xfs = mockfs.fs()
  mkdirp file,
    fs: xfs
    mode: 0755
  , (err) ->
    t.ifError err
    xfs.exists file, (ex) ->
      t.ok ex, "created file"
      xfs.stat file, (err, stat) ->
        t.ifError err
        t.equal stat.mode & 0777, 0755
        t.ok stat.isDirectory(), "target not a directory"
        return

      return

    return

  return

