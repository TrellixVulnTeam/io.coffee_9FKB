mkdirp = require("../")
path = require("path")
fs = require("fs")
exists = fs.exists or path.exists
test = require("tap").test
test "sync perm", (t) ->
  t.plan 4
  file = "/tmp/" + (Math.random() * (1 << 30)).toString(16) + ".json"
  mkdirp.sync file, 0755
  exists file, (ex) ->
    t.ok ex, "file created"
    fs.stat file, (err, stat) ->
      t.ifError err
      t.equal stat.mode & 0777, 0755
      t.ok stat.isDirectory(), "target not a directory"
      return

    return

  return

test "sync root perm", (t) ->
  t.plan 3
  file = "/tmp"
  mkdirp.sync file, 0755
  exists file, (ex) ->
    t.ok ex, "file created"
    fs.stat file, (err, stat) ->
      t.ifError err
      t.ok stat.isDirectory(), "target not a directory"
      return

    return

  return

