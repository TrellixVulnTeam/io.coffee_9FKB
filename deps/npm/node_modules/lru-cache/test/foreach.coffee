test = require("tap").test
LRU = require("../")
test "forEach", (t) ->
  l = new LRU(5)
  i = 0

  while i < 10
    l.set i.toString(), i.toString(2)
    i++
  i = 9
  l.forEach (val, key, cache) ->
    t.equal cache, l
    t.equal key, i.toString()
    t.equal val, i.toString(2)
    i -= 1
    return

  
  # get in order of most recently used
  l.get 6
  l.get 8
  order = [
    8
    6
    9
    7
    5
  ]
  i = 0
  l.forEach (val, key, cache) ->
    j = order[i++]
    t.equal cache, l
    t.equal key, j.toString()
    t.equal val, j.toString(2)
    return

  t.end()
  return

test "keys() and values()", (t) ->
  l = new LRU(5)
  i = 0

  while i < 10
    l.set i.toString(), i.toString(2)
    i++
  t.similar l.keys(), [
    "9"
    "8"
    "7"
    "6"
    "5"
  ]
  t.similar l.values(), [
    "1001"
    "1000"
    "111"
    "110"
    "101"
  ]
  
  # get in order of most recently used
  l.get 6
  l.get 8
  t.similar l.keys(), [
    "8"
    "6"
    "9"
    "7"
    "5"
  ]
  t.similar l.values(), [
    "1000"
    "110"
    "1001"
    "111"
    "101"
  ]
  t.end()
  return

