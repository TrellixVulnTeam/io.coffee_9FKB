fstream = require("../fstream.js")
closed = false
# octal strings supported
fstream.Writer(
  path: "path/to/symlink"
  linkpath: "./file"
  isSymbolicLink: true
  mode: "0755"
).on("close", ->
  closed = true
  fs = require("fs")
  s = fs.lstatSync("path/to/symlink")
  isSym = s.isSymbolicLink()
  console.log ((if isSym then "" else "not ")) + "ok 1 should be symlink"
  t = fs.readlinkSync("path/to/symlink")
  isTarget = t is "./file"
  console.log ((if isTarget then "" else "not ")) + "ok 2 should link to ./file"
  return
).end()
process.on "exit", ->
  console.log ((if closed then "" else "not ")) + "ok 3 should be closed"
  return

