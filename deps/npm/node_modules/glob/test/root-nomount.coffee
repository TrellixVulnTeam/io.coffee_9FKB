tap = require("tap")
origCwd = process.cwd()
process.chdir __dirname
tap.test "changing root and searching for /b*/**", (t) ->
  glob = require("../")
  path = require("path")
  t.test ".", (t) ->
    glob "/b*/**",
      globDebug: true
      root: "."
      nomount: true
    , (er, matches) ->
      t.ifError er
      t.like matches, []
      t.end()
      return

    return

  t.test "a", (t) ->
    glob "/b*/**",
      globDebug: true
      root: path.resolve("a")
      nomount: true
    , (er, matches) ->
      t.ifError er
      t.like matches, [
        "/b"
        "/b/c"
        "/b/c/d"
        "/bc"
        "/bc/e"
        "/bc/e/f"
      ]
      t.end()
      return

    return

  t.test "root=a, cwd=a/b", (t) ->
    glob "/b*/**",
      globDebug: true
      root: "a"
      cwd: path.resolve("a/b")
      nomount: true
    , (er, matches) ->
      t.ifError er
      t.like matches, [
        "/b"
        "/b/c"
        "/b/c/d"
        "/bc"
        "/bc/e"
        "/bc/e/f"
      ]
      t.end()
      return

    return

  t.test "cd -", (t) ->
    process.chdir origCwd
    t.end()
    return

  t.end()
  return

