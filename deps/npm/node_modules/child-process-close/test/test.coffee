next = ->
  test = TESTS.shift()
  done()  unless test
  console.log "Running test: %s", test
  execFile process.execPath, [test],
    cwd: __dirname
  , onExit
  return
onExit = (err, stdout, stderr) ->
  if err
    console.log "... failed:\n%s%s\n", stdout, stderr
    failed++
  else
    console.log "... pass"
    passed++
  next()
  return
done = ->
  console.log "Tests run: %d. Passed: %d. Failed: %d", passed + failed, passed, failed
  process.exit +(failed > 0)
  return
TESTS = [
  "test-spawn-and-execfile"
  "test-fork"
  "test-exec"
]
execFile = require("child_process").execFile
passed = 0
failed = 0
next()
