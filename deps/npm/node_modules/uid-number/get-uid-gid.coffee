throw new Error("This file should not be loaded with require()")  if module isnt require.main
throw new Error("this file should not be called without uid/gid support")  if not process.getuid or not process.getgid
argv = process.argv.slice(2)
user = argv[0] or process.getuid()
group = argv[1] or process.getgid()
user = +user  unless isNaN(user)
group = +group  unless isNaN(group)
console.error [
  user
  group
]
try
  process.setgid group
  process.setuid user
  console.log JSON.stringify(
    uid: +process.getuid()
    gid: +process.getgid()
  )
catch ex
  console.log JSON.stringify(
    error: ex.message
    errno: ex.errno
  )
