spawn = require("child_process").spawn
module.exports = (file, opts, cb) ->
  if typeof opts is "function"
    cb = opts
    opts = {}
  opts = {}  unless opts
  ed = (if /^win/.test(process.platform) then "notepad" else "vim")
  editor = opts.editor or process.env.VISUAL or process.env.EDITOR or ed
  args = editor.split(/\s+/)
  bin = args.shift()
  ps = spawn(bin, args.concat([file]),
    stdio: "inherit"
  )
  ps.on "exit", (code, sig) ->
    cb code, sig  if typeof cb is "function"
    return

  return
