# just like the Entry class, but it buffers the contents
#
# XXX It would be good to set a maximum BufferEntry filesize,
# since it eats up memory.  In normal operation,
# these are only for long filenames or link names, which are
# rarely very big.
BufferEntry = ->
  Entry.apply this, arguments
  @_buffer = new Buffer(@props.size)
  @_offset = 0
  @body = ""
  @on "end", ->
    @body = @_buffer.toString().slice(0, -1)
    return

  return
module.exports = BufferEntry
inherits = require("inherits")
Entry = require("./entry.js")
inherits BufferEntry, Entry

# collect the bytes as they come in.
BufferEntry::write = (c) ->
  c.copy @_buffer, @_offset
  @_offset += c.length
  Entry::write.call this, c
  return
