test = require("tap").test
promzard = require("../")
test "simple", (t) ->
  t.plan 1
  ctx = tmpdir: "/tmp"
  file = __dirname + "/simple.input"
  promzard file, ctx, (err, output) ->
    t.same
      a: 3
      b: "!2b"
      c:
        x: 55
        y: "/tmp/y/file.txt"
    , output
    return

  setTimeout (->
    process.stdin.emit "data", "\n"
    return
  ), 100
  setTimeout (->
    process.stdin.emit "data", "55\n"
    return
  ), 200
  return

