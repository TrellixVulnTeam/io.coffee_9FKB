once = (fn) ->
  f = ->
    return f.value  if f.called
    f.called = true
    f.value = fn.apply(this, arguments)

  f.called = false
  f
wrappy = require("wrappy")
module.exports = wrappy(once)
once.proto = once(->
  Object.defineProperty Function::, "once",
    value: ->
      once this

    configurable: true

  return
)
