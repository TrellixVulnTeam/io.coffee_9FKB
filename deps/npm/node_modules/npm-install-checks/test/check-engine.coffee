test = require("tap").test
c = require("../index.js").checkEngine
test "no engine defined", (t) ->
  c
    engines: {}
  , "1.1.2", "0.2.1", false, true, (err) ->
    t.notOk err, "no error present"
    t.end()
    return

  return

test "node version too old", (t) ->
  target = engines:
    node: "0.10.24"

  c target, "1.1.2", "0.10.18", false, true, (err) ->
    t.ok err, "returns an error"
    t.equals err.required.node, "0.10.24"
    t.end()
    return

  return

test "npm version too old", (t) ->
  target = engines:
    npm: "1.3.6"

  c target, "1.4.2", "0.2.1", false, true, (err) ->
    t.ok err, "returns an error"
    t.equals err.required.npm, "1.3.6"
    t.end()
    return

  return

test "strict=false does not return an error", (t) ->
  target = engines:
    npm: "1.3.6"

  c target, "1.4.2", "0.2.1", false, false, (err) ->
    t.notOk err, "returns no error"
    t.end()
    return

  return

