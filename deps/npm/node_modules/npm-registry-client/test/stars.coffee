tap = require("tap")
server = require("./lib/server.js")
common = require("./lib/common.js")
client = common.freshClient()
users = [
  "benjamincoe"
  "seldo"
  "ceejbot"
]
tap.test "get the URL for the bugs page on a package", (t) ->
  server.expect "GET", "/-/_view/starredByUser?key=%22sample%22", (req, res) ->
    t.equal req.method, "GET"
    res.json users
    return

  client.stars "http://localhost:1337/", "sample", (error, info) ->
    t.ifError error, "no errors"
    t.deepEqual info, users, "got the list of users"
    t.end()
    return

  return

